(function(p){typeof define=="function"&&define.amd?define(p):p()})(function(){"use strict";let p=null;const C=({options:n})=>{const{rectColor:t="#333333",highlightRectColor:i="#0099ff"}=n,o=`
        body {
            background-color: #ffffff;
            /* color: #999999; */
            font-size: 12px;
        }
        p {font-size: .32rem; margin:0; line-height: 1.2;}

        .container {
            width: 100%;
            box-sizing: border-box;
            padding: .266667rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .right {text-align: right;}

        .row {height: auto; line-height: 1;}
        .ceil {
            display: inline-block;
            width: .2rem;
            height: .2rem;
            background: #f3f3f3;
            margin-right: .04rem;
            cursor: pointer;
        }

        .ceil.past {
            background: ${t};
        }

        .ceil.today {
            background: ${i};
        }
        #percent {font-size: .48rem; margin: .133333rem 0; color: ${t};}
        #percent em {font-style: normal; font-size: .32rem;}
        html[theme="dark"], html[theme="dark"] body {background-color:#191919; color:#ffffff;}
        html[theme="dark"] .ceil {background-color:rgb(255, 255, 255, .2);}
        html[theme="dark"] .ceil.past {background-color:rgb(255, 255, 255,1)}
        html[theme="dark"] .ceil.today {background-color:lightblue;}
        html[theme="dark"] #percent {color:rgb(255, 255, 255,1)}
 `,e=document.querySelector("head");p&&(p.remove(),p=null),p=document.createElement("style"),p.innerHTML=o,e==null||e.append(p)};(function(n,t){function i(){var s=c.getBoundingClientRect().width;s/r>540&&(s=540*r);var g=s/10;c.style.fontSize=g+"px",u.rem=n.rem=g}var o,e=n.document,c=e.documentElement,a=e.querySelector('meta[name="viewport"]'),f=e.querySelector('meta[name="flexible"]'),r=0,l=0,u=t.flexible||(t.flexible={});if(a){console.warn("\u5C06\u6839\u636E\u5DF2\u6709\u7684meta\u6807\u7B7E\u6765\u8BBE\u7F6E\u7F29\u653E\u6BD4\u4F8B");var m=a.getAttribute("content").match(/initial\-scale=([\d\.]+)/);m&&(l=parseFloat(m[1]),r=parseInt(1/l))}else if(f){var E=f.getAttribute("content");if(E){var h=E.match(/initial\-dpr=([\d\.]+)/),d=E.match(/maximum\-dpr=([\d\.]+)/);h&&(r=parseFloat(h[1]),l=parseFloat((1/r).toFixed(2))),d&&(r=parseFloat(d[1]),l=parseFloat((1/r).toFixed(2)))}}if(!r&&!l&&(n.navigator.appVersion.match(/android/gi),n.navigator.appVersion.match(/iphone/gi),n.devicePixelRatio,r=1,l=1/r),c.setAttribute("data-dpr",r),!a)if(a=e.createElement("meta"),a.setAttribute("name","viewport"),a.setAttribute("content","initial-scale="+l+", maximum-scale="+l+", minimum-scale="+l+", user-scalable=no"),c.firstElementChild)c.firstElementChild.appendChild(a);else{var b=e.createElement("div");b.appendChild(a),e.write(b.innerHTML)}n.addEventListener("resize",function(){clearTimeout(o),o=setTimeout(i,300)},!1),n.addEventListener("pageshow",function(s){s.persisted&&(clearTimeout(o),o=setTimeout(i,300))},!1),e.readyState==="complete"?e.body.style.fontSize=12*r+"px":e.addEventListener("DOMContentLoaded",function(){e.body.style.fontSize=12*r+"px"},!1),i(),u.dpr=n.dpr=r,u.refreshRem=i,u.rem2px=function(s){var g=parseFloat(s)*this.rem;return typeof s=="string"&&s.match(/rem$/)&&(g+="px"),g},u.px2rem=function(s){var g=parseFloat(s)/this.rem;return typeof s=="string"&&s.match(/px$/)&&(g+="rem"),g}})(window,window.lib||(window.lib={})),function(n,t){function i(d){var b=parseFloat(d.designWidth),s=parseFloat(d.designUnit),g=parseFloat(d.columnCount),j=parseFloat(d.columnXUnit),D=parseFloat(d.gutterXUnit),W=parseFloat(d.edgeXUnit),w=d.className||"grid";if(!(d.designWidth&&d.designUnit&&d.columnCount&&d.columnXUnit&&d.gutterXUnit&&d.edgeXUnit))throw new Error("\u53C2\u6570\u9519\u8BEF");t.flexible.gridParams=d;for(var F=s/b*10,A=j*F,U=D*F,T=W*F,B=["."+w+" {","box-sizing:content-box;","padding-left: "+T+"rem;","padding-right: "+T+"rem;","margin-left: -"+U+"rem;","}","."+w+":before,","."+w+":after{",'content: " ";',"display: table;","}","."+w+":after {","clear: both;","}","."+w+' [class^="col-"] {',"margin-left: "+U+"rem;","float: left;","}"],y=1;g>=y;y++){var H=A*y+U*(y-1);B.push("."+w+" .col-"+y+" {width: "+H+"rem;}")}e&&e.parentNode&&e.parentNode.removeChild(e),e=c.createElement("style"),e.innerHTML=B.join("");var N=c.querySelector("head")||a.firstElementChild||a;N.appendChild(e)}function o(d){var b=l[d];if(!b)throw new Error("\u4E0D\u652F\u6301\u8FD9\u4E2A\u9884\u8BBE\u6A21\u5F0F");i(b)}var e,c=n.document,a=c.documentElement,f=c.querySelector('meta[name="grid"]'),r=t.flexible||(t.flexible={}),l={"750-12":{designWidth:750,designUnit:6,columnCount:12,columnXUnit:7,gutterXUnit:3,edgeXUnit:4},"750-6":{designWidth:750,designUnit:6,columnCount:6,columnXUnit:17,gutterXUnit:3,edgeXUnit:4},"640-12":{designWidth:640,designUnit:4,columnCount:12,columnXUnit:11,gutterXUnit:2,edgeXUnit:3},"640-6":{designWidth:640,designUnit:4,columnCount:6,columnXUnit:24,gutterXUnit:2,edgeXUnit:3}};if(f){var u=f.getAttribute("content");if(u){for(var m,E=/([^=]+)=([\d\.\-]+)/g,h={};m=E.exec(u);)h[m[1]]=m[2];h.modeName?o(h.modeName):i(h)}}r.makeGrid=i,r.makeGridMode=o}(window,window.lib||(window.lib={}));const v={};class ${constructor(){this.call=this.call.bind(this),this.bind=this.bind.bind(this)}call(t,i){v[t]&&Object.entries(v[t]).forEach(([o,e=()=>{}])=>{e(i)})}bind(t,i=()=>{}){v[t]||(v[t]={});const o=new Date().getTime();return v[t][o]=i,{call:this.call,cancel:()=>{delete v[t][o]}}}}const X=()=>(window.NotionPetEvent||(window.NotionPetEvent=new $),window.NotionPetEvent),L=(n,t=!1)=>{const{bind:i,call:o}=X();i("onRenderWidget",n),t&&n({options:void 0,data:void 0}),o("onWidgetsRenderDone")},M=n=>{const{bind:t}=X();t("onWeightUpdate",n)},S=document.querySelector("#app");let x={rectColor:"#333333",highlightRectColor:"#0099ff"};function z(){let n=[0,31,28,31,30,31,30,31,31,30,31,30,31],t=new Date,i,o=365;i=t.getFullYear();let e=t.getMonth()+1,c=t.getDate();i%4===0&&i%100!=0&&(n[2]=29,o=366),console.log(i,e,c);let a="",f=0,r=0;for(let l=1;l<=12;l++){a+=`<div class="row row-${l}">`;for(let u=1;u<=n[l];u++){let m="";e>l||e===l&&u<c?(m="past",f++):e===l&&u===c?(m="today",f++):e<l&&(m="future"),a+=`<span class="ceil ${m}"></span>`}a+="</div>"}r=(f*100/o).toFixed(1),document.getElementById("ceils").innerHTML=a,document.getElementById("date").innerHTML=`${i}/${e}/${c}`,document.getElementById("percent").innerHTML=`${r}<em>%</em>`,document.getElementById("days").innerHTML=`${f}/${o}`}const k=({data:n={good:0,noGood:0}})=>{setTimeout(z,0),S.innerHTML=`
  <div class="container">
        <div class="left" id="ceils"></div>
        <div class="right">
            <p id="date"></p>
            <h2 id="percent"></h2>
            <p id="days"></p>
        </div>
    </div>
  `};L(({options:n={},data:t={}})=>{Object.entries(n).forEach(([i,o])=>x[i]=o),C({options:x}),k({data:t})},!1),M(({options:n={},data:t={}})=>{Object.entries(n).forEach(([i,o])=>x[i]=o),k({data:t}),C({options:x})})});
